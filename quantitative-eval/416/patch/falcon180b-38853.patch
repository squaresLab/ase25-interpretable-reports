 
    
    --- falcon180b-38853.c
    +++ falcon180b-38853-fixed.c
    @@ -13,6 +13,7 @@
     #define BUFFER_SIZE 1024

     int clients[MAX_CLIENTS];
     int num_clients = 0;
    +pthread_mutex_t clients_mutex = PTHREAD_MUTEX_INITIALIZER;

     void *handle_client(void *socket_desc) {
         int client_socket = *(int *) socket_desc;
    @@ -44,16 +45,20 @@
         while (1) {
             int client_socket = accept(server_socket, NULL, NULL);
             if (num_clients >= MAX_CLIENTS) {
                 send(client_socket, "Server is full\n", strlen("Server is full\n"), 0);
                 close(client_socket);
             } else {
    +            pthread_mutex_lock(&clients_mutex);
                 clients[num_clients] = client_socket;
                 num_clients++;
    +            pthread_mutex_unlock(&clients_mutex);
                 pthread_t thread_id;
                 pthread_create(&thread_id, NULL, handle_client, (void *) &client_socket);
             }
         }

         return 0;
     }
    

    