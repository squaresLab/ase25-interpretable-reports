 

  // Create the threads
  for (int i = 0; i < NUM_THREADS; i++) {
+   int *arg = malloc(sizeof(*arg));
+   if (arg == NULL) {
+     fprintf(stderr, "Couldn't allocate memory for thread arg.\n");
+     exit(EXIT_FAILURE);
+   }
+   *arg = i;
    pthread_create(&threads[i], NULL, generate_primes, arg);
  }

  // Wait for the threads to finish
  for (int i = 0; i < NUM_THREADS; i++) {
    pthread_join(threads[i], NULL);
+   free(arg);
  }

