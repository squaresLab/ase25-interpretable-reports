 

diff --git a/falcon180b-7491 b/falcon180b-7491
index abcdef..123456 100644
--- a/falcon180b-7491
+++ b/falcon180b-7491
@@ -23,6 +23,7 @@ void *handle_client(void *args) {
         memset(buffer, 0, BUFFER_SIZE);
         int bytes_received = recv(client_socket, buffer, BUFFER_SIZE, 0);
         if(bytes_received <= 0) {
+            if(bytes_received == -1) {
+                perror("recv");
+                close(client_socket);
+                pthread_exit(NULL);
+            }
             printf("Client %d disconnected\n", client_socket);
             close(client_socket);
             pthread_exit(NULL);
         }
+        if (bytes_received >= BUFFER_SIZE) {
+            perror("Buffer overflow attempt detected");
+            close(client_socket);
+            pthread_exit(NULL);
+        }
         printf("Received message from client %d: %s", client_socket, buffer);
     }
 }
 
int main() {
    int opt = 1;
    setsockopt(server_socket, SOL_SOCKET, SO_REUSEADDR, &opt, sizeof(opt));
 
    while(1) {
        printf("Waiting for client connection...\n");
+        socklen_t addr_len = sizeof(client_addr);
        int client_socket = accept(server_socket, (struct sockaddr *) &client_addr, &addr_len);
        printf("Client connected with socket %d\n", client_socket);
 
        pthread_t thread_id;
        pthread_create(&thread_id, NULL, handle_client, (void *) &client_socket);
    }

