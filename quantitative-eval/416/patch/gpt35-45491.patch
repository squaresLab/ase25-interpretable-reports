

--- gpt35-45491.c
+++ gpt35-45491.c
@@ -49,12 +49,20 @@
         int client_socket = accept(server_socket, NULL, NULL);
         if (client_socket < 0) {
             printf("Failed to accept incoming connection\n");
             close(server_socket);
             return -1;
         }

+        // Allocate memory for client_socket argument and assign value
+        int *client_sock_ptr = malloc(sizeof(int));
+        if (client_sock_ptr == NULL) {
+            printf("Memory allocation failed\n");
+            close(client_socket);
+            continue;
+        }
+        *client_sock_ptr = client_socket;
+
         // create thread for client handling
         pthread_t tid;
-        if (pthread_create(&tid, NULL, client_handler, (void *)&client_socket) < 0) {
+        if (pthread_create(&tid, NULL, client_handler, (void *)client_sock_ptr) < 0) {
             printf("Failed to create client handling thread\n");
             close(client_socket);
+            free(client_sock_ptr);
             continue;
         }
     }
 }

