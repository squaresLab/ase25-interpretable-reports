

--- codellama_13b-11603.c
+++ codellama_13b-11603-fixed.c
@@ -6,6 +6,7 @@
 #include <stdlib.h>
 #include <string.h>
 
+#define MAX_SENTENCE_LENGTH 1000
 #define MAX_SENTENCES 100
 #define MAX_LENGTH 1000
 
@@ -14,13 +15,16 @@
 char* get_sentence() {
   char sentence[MAX_LENGTH];
   fgets(sentence, MAX_LENGTH, stdin);
-  return sentence;
+  char* result = malloc(MAX_LENGTH);
+  if (result != NULL) {
+    strncpy(result, sentence, MAX_LENGTH);
+  }
+  return result;
 }
 
 // Function to count the number of sentences in a given string
 int count_sentences(char* str) {
   int count = 0;
-  for (int i = 0; i < strlen(str); i++) {
+  for (size_t i = 0; i < strlen(str); i++) {
     if (str[i] == '.') {
       count++;
     }
@@ -34,9 +38,14 @@
 char* get_important_sentences(char* str) {
   int count = count_sentences(str);
   char* sentences[MAX_SENTENCES];
+  char* copy_str = strdup(str);
+  if (copy_str == NULL) return NULL;
   for (int i = 0; i < count; i++) {
-    sentences[i] = strtok(str, ".");
-    str = strtok(NULL, ".");
+    sentences[i] = strtok(copy_str, ".");
+    copy_str = strtok(NULL, ".");
   }
-  return sentences;
+  free(copy_str);
+  // Combine sentences into a single string to return
+  char* result = malloc(MAX_SENTENCES * MAX_SENTENCE_LENGTH);
+  if (result != NULL) {
+    strcpy(result, sentences[0]);
+  }
+  return result;
 }
 
 // Function to summarize a given string
@@ -45,17 +54,21 @@
 char* summarize(char* str) {
   char* summary = malloc(MAX_LENGTH);
   strcpy(summary, "");
   int count = count_sentences(str);
   char* sentences[MAX_SENTENCES];
+  char* copy_str = strdup(str);
+  if (copy_str == NULL) return NULL;
   for (int i = 0; i < count; i++) {
-    sentences[i] = strtok(str, ".");
-    str = strtok(NULL, ".");
+    sentences[i] = strtok(copy_str, ".");
+    copy_str = strtok(NULL, ".");
   }
+  free(copy_str);
   for (int i = 0; i < count; i++) {
-    strcat(summary, sentences[i]);
-    strcat(summary, ".");
+    strncat(summary, sentences[i], MAX_LENGTH - strlen(summary) - 1);
+    strncat(summary, ".", MAX_LENGTH - strlen(summary) - 1);
   }
   return summary;
 }
 
 // Main function
 int main() {
   char* str = get_sentence();
   char* summary = summarize(str);
   printf("Summary: %s\n", summary);
+  free(str);
+  free(summary);
   return 0;
 }


