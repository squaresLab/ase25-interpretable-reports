 

--- gemini_pro-23004.c
+++ gemini_pro-23004_fix.c
@@ -47,7 +47,7 @@
 
     // Listen for incoming connections
     int client_sockfd;
+    int *pclient;
     struct sockaddr_in client_addr;
     socklen_t client_addr_len = sizeof(client_addr);
     while ((client_sockfd = accept(server_sockfd, (struct sockaddr *)&client_addr, &client_addr_len)) >= 0)
     {
+        pclient = malloc(sizeof(int));  // Allocate memory for client socket descriptor
+        if (pclient == NULL)
+        {
+            perror("malloc");
+            close(client_sockfd);
+            continue;
+        }
+        *pclient = client_sockfd;
         pthread_t client_thread_id;
 
         // Create a new thread to handle the client connection
-        if (pthread_create(&client_thread_id, NULL, client_thread, &client_sockfd) != 0)
+        if (pthread_create(&client_thread_id, NULL, client_thread, pclient) != 0)
         {
             perror("pthread_create");
             exit(EXIT_FAILURE);
         }
+        pthread_detach(client_thread_id);  // Detach the thread to avoid memory leaks
     }
 
     if (client_sockfd == -1)
     {
         perror("accept");
         exit(EXIT_FAILURE);
     }

