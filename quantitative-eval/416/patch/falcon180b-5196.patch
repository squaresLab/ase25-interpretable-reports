 

@@ -18,6 +18,13 @@
     while (1) {
         memset(buffer, 0, sizeof(buffer));
         int bytes_received = recv(client_socket, buffer, sizeof(buffer), 0);
+        if (bytes_received < 0) {
+            perror("recv failed");
+            break;
+        }
+
+        // Add input validation
+        if (!isValidInput(buffer, bytes_received)) {
+            send(client_socket, "Invalid input.\n", 15, 0);
+            continue;
+        }

@@ -31,6 +38,12 @@
 void broadcast_message(int sender_socket, char *message) {
+    if (!isValidInput(message, strlen(message))) {
+        send(sender_socket, "Invalid input.\n", 15, 0);
+        return;
+    }
+
     for (int i = 0; i < num_clients; i++) {
         if (clients[i] != sender_socket) {

