 

--- gpt35-59112.c    (original)
+++ gpt35-59112.c    (fixed)
@@ -61,11 +61,13 @@
         if (client_socket_fd == -1) {
             perror("Failed to accept client connection");
             continue;
         }

         printf("Client %d connected\n", client_count + 1);

+        int *new_sock = malloc(sizeof(int));
+        *new_sock = client_socket_fd;

         // Locking mutex to prevent race condition between threads
         pthread_mutex_lock(&mutex);

         // Creating a new thread to handle client requests
-        if (pthread_create(&thread_ids[client_count], NULL, handle_client, &client_socket_fd) != 0) {
+        if (pthread_create(&thread_ids[client_count], NULL, handle_client, new_sock) != 0) {
             perror("Failed to create thread");
             exit(EXIT_FAILURE);
         }

