
    
    --- falcon180b-71515-original.c
    +++ falcon180b-71515-fixed.c
    @@ -19,7 +19,7 @@
         while (1) {
             memset(buffer, 0, BUFFER_SIZE);
             int bytes_received = recv(client_socket, buffer, BUFFER_SIZE - 1, 0);
     
    -        if (bytes_received <= 0) {
    +        if (bytes_received <= 0 || bytes_received >= BUFFER_SIZE) {
                 break;
             }
     
    @@ -34,8 +34,8 @@
         close(client_socket);
     
         for (int i = 0; i < num_clients; i++) {
             if (clients[i] == client_socket) {
                 clients[i] = -1;
                 break;
             }
         }
    +    num_clients--;
     }
    
    