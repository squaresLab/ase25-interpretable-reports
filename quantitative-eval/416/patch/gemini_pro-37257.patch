 

    // Define the thread function
    void* thread_func(void* arg) {
        // Get the client socket
        int client_sock = *(int*)arg;

        // Get the client address
        struct sockaddr_in client_addr;
        socklen_t client_addr_len = sizeof(client_addr);
        getpeername(client_sock, (struct sockaddr*)&client_addr, &client_addr_len);

        // Print the client address
        printf("Client connected: %s:%d\n", inet_ntoa(client_addr.sin_addr), ntohs(client_addr.sin_port));

        // Loop until the client disconnects
        while (1) {
            // Receive a message from the client
            char msg[MAX_MSG_LEN];
            int msg_len = recv(client_sock, msg, MAX_MSG_LEN, 0);

            // If the client disconnected, break the loop
            if (msg_len <= 0) {
                break;
            }

            // Print the message
            printf("Client: %s\n", msg);

            // Send a message to the client
            char reply[MAX_MSG_LEN];
+            snprintf(reply, sizeof(reply), "Server: %s", msg);
-            sprintf(reply, "Server: %s", msg);
            send(client_sock, reply, strlen(reply), 0);
        }

        // Close the client socket
        close(client_sock);

        // Decrement the number of clients
        pthread_mutex_lock(&mutex);
        num_clients--;
        pthread_mutex_unlock(&mutex);

        // Signal the condition variable
        pthread_cond_signal(&cond);

        // Return NULL
        return NULL;
    }

