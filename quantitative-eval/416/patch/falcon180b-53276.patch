 

diff --git a/falcon180b-53276 b/falcon180b-53276
index abcdefg..xyz1234 100644
--- a/falcon180b-53276
+++ b/falcon180b-53276
@@ -14,7 +14,8 @@ int num_clients = 0;
 int max_clients = 0;
 
 void *thread_func(void *arg) {
-    int client_socket = *(int *) arg;
+    int client_socket = *(int *)arg;
+    int index = -1;
     char buffer[BUFFER_SIZE];
     while (1) {
         memset(buffer, 0, BUFFER_SIZE);
@@ -23,6 +24,9 @@ void *thread_func(void *arg) {
         }
         printf("Client %d sent message: %s\n", client_socket, buffer);
         for (int i = 0; i < num_clients; i++) {
-            if (i!= client_socket) {
+            if (client_sockets[i] == client_socket) {
+                index = i;
+            }
+            if (client_sockets[i] != client_socket) {
                 send(client_sockets[i], buffer, bytes_received, 0);
             }
         }
@@ -30,6 +34,11 @@ void *thread_func(void *arg) {
     close(client_socket);
+    if (index != -1) {
+        for (int i = index; i < num_clients - 1; i++) {
+            client_sockets[i] = client_sockets[i + 1];
+        }
+        num_clients--;
+    }
     return NULL;
 }
 
@@ -41,6 +50,7 @@ int main() {
     setsockopt(server_socket, SOL_SOCKET, SO_REUSEADDR, &opt, sizeof(opt));
 
     while (1) {
+        printf("Waiting for clients...\n");
         struct sockaddr_in client_addr;
         socklen_t addr_len = sizeof(client_addr);
         int client_socket = accept(server_socket, (struct sockaddr *) &client_addr, &addr_len);
@@ -51,6 +64,8 @@ int main() {
 
         pthread_t thread_id;
         pthread_create(&thread_id, NULL, thread_func, (void *) &client_socket);
+        client_sockets[num_clients++] = client_socket;
     }
 
     return 0;
 
