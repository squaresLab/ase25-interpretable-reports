 
    
    --- gpt35-38507.c 2023-10-10 12:00:00.000000000 +0000
    +++ gpt35-38507.c 2023-10-10 12:00:00.000000000 +0000
    @@ -78,15 +78,18 @@
        int dx = rand() % 3 - 1;
        int dy = rand() % 3 - 1;
 
        if (dx || dy) {
    -        if (!state->map[state->monsters[i].x+dx][state->monsters[i].y+dy]) {
    +        int new_x = state->monsters[i].x + dx;
    +        int new_y = state->monsters[i].y + dy;
    +        if (new_x >= 0 && new_x < MAP_WIDTH && new_y >= 0 && new_y < MAP_HEIGHT &&
    +            !state->map[new_x][new_y]) {
                 state->map[state->monsters[i].x][state->monsters[i].y] = 0;
                 state->monsters[i].x += dx;
                 state->monsters[i].y += dy;
    @@ -94,20 +97,23 @@
        char input;
 
        printf("Enter a command (w/a/s/d): ");
        scanf(" %c", &input);
 
    -    if (input == 'w' && !state.map[state.player.x][state.player.y-1]) {
    +    if (input == 'w' && state.player.y > 0 && !state.map[state.player.x][state.player.y-1]) {
             state.map[state.player.x][state.player.y] = 0;
             state.player.y--;
             state.map[state.player.x][state.player.y] = state.player.symbol;
         }
    -    else if (input == 's' && !state.map[state.player.x][state.player.y+1]) {
    +    else if (input == 's' && state.player.y < MAP_HEIGHT-1 && !state.map[state.player.x][state.player.y+1]) {
             state.map[state.player.x][state.player.y] = 0;
             state.player.y++;
             state.map[state.player.x][state.player.y] = state.player.symbol;
         }
    -    else if (input == 'a' && !state.map[state.player.x-1][state.player.y]) {
    +    else if (input == 'a' && state.player.x > 0 && !state.map[state.player.x-1][state.player.y]) {
             state.map[state.player.x][state.player.y] = 0;
             state.player.x--;
             state.map[state.player.x][state.player.y] = state.player.symbol;
         }
    -    else if (input == 'd' && !state.map[state.player.x+1][state.player.y]) {
    +    else if (input == 'd' && state.player.x < MAP_WIDTH-1 && !state.map[state.player.x+1][state.player.y]) {
             state.map[state.player.x][state.player.y] = 0;
             state.player.x++;
             state.map[state.player.x][state.player.y] = state.player.symbol;
         }
    @@ -34,10 +43,16 @@
        rooms[i].y = rand() % (MAP_HEIGHT - rooms[i].h - 2) + 1;
 
        for (j = rooms[i].x; j < rooms[i].x + rooms[i].w; j++) {
            for (k = rooms[i].y; k < rooms[i].y + rooms[i].h; k++) {
    -            state->map[j][k] = 1;
    +            if (j >= 0 && j < MAP_WIDTH && k >= 0 && k < MAP_HEIGHT) {
    +                state->map[j][k] = 1;
    +            }
            }
        }
    
    